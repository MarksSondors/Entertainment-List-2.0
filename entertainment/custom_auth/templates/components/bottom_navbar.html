<!-- filepath: entertainment/custom_auth/templates/components/bottom_navbar.html -->
{% load static %}

<nav class="bottom-navbar" style="
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #c0c0c0;
    border-top: 2px outset #ffffff;
    padding: 8px 0;
    display: flex;
    justify-content: space-around;
    align-items: center;
    z-index: 1000;
    box-shadow: 0 -2px 4px rgba(0,0,0,0.2);
">
    <!-- Watchlist Button -->
    <a href="{% url 'watchlist_page' %}" class="navbar-item {% if request.resolver_match.url_name == 'watchlist_page' %}active{% endif %}" 
       style="
           flex: 1;
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           text-decoration: none;
           color: {% if request.resolver_match.url_name == 'watchlist_page' %}#008080{% else %}#000000{% endif %};
           padding: 4px 8px;
           position: relative;
       ">
        <div class="icon" style="
            font-size: 24px;
            margin-bottom: 2px;
            {% if request.resolver_match.url_name == 'watchlist_page' %}
            color: #008080;
            font-weight: bold;
            {% endif %}
        ">üìã</div>
        <span style="
            font-size: 12px;
            {% if request.resolver_match.url_name == 'watchlist_page' %}
            font-weight: bold;
            {% endif %}
        ">Watchlist</span>
        {% if request.resolver_match.url_name == 'watchlist_page' %}
        <div style="
            position: absolute;
            bottom: -8px;
            height: 4px;
            width: 50%;
            background-color: #008080;
            border-radius: 2px;
        "></div>
        {% endif %}
    </a>

    <!-- Discover Button -->
    <a href="{% url 'discover_page' %}" class="navbar-item {% if request.resolver_match.url_name == 'discover_page' %}active{% endif %}"
       style="
           flex: 1;
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           text-decoration: none;
           color: {% if request.resolver_match.url_name == 'discover_page' %}#008080{% else %}#000000{% endif %};
           padding: 4px 8px;
           position: relative;
       ">
        <div class="icon" style="
            font-size: 24px;
            margin-bottom: 2px;
            {% if request.resolver_match.url_name == 'discover_page' %}
            color: #008080;
            font-weight: bold;
            {% endif %}
        ">üîç</div>
        <span style="
            font-size: 12px;
            {% if request.resolver_match.url_name == 'discover_page' %}
            font-weight: bold;
            {% endif %}
        ">Discover</span>
        {% if request.resolver_match.url_name == 'discover_page' %}
        <div style="
            position: absolute;
            bottom: -8px;
            height: 4px;
            width: 50%;
            background-color: #008080;
            border-radius: 2px;
        "></div>
        {% endif %}
    </a>

    <!-- Profile Button - Modified to be a direct link -->
    <a href="{% url 'profile_page' %}" class="navbar-item {% if request.resolver_match.url_name == 'profile_page' %}active{% endif %}"
       style="
           flex: 1;
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           text-decoration: none;
           color: {% if request.resolver_match.url_name == 'profile_page' %}#008080{% else %}#000000{% endif %};
           padding: 4px 8px;
           position: relative;
       ">
        <div class="icon" style="
            font-size: 24px;
            margin-bottom: 2px;
            {% if request.resolver_match.url_name == 'profile_page' %}
            color: #008080;
            font-weight: bold;
            {% endif %}
        ">üë§</div>
        <span style="
            font-size: 12px;
            {% if request.resolver_match.url_name == 'profile_page' %}
            font-weight: bold;
            {% endif %}
        ">Profile</span>
        {% if request.resolver_match.url_name == 'profile_page' %}
        <div style="
            position: absolute;
            bottom: -8px;
            height: 4px;
            width: 50%;
            background-color: #008080;
            border-radius: 2px;
        "></div>
        {% endif %}
    </a>
</nav>

<!-- Add CSS for dark mode compatibility -->
<style>
    /* Bottom navbar base styles with better mobile support */
    .bottom-navbar {
        height: 60px !important;
        min-height: 60px !important;
        padding-bottom: env(safe-area-inset-bottom, 0px) !important;
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        width: 100% !important;
        z-index: 99999 !important;
        transform: translate3d(0, 0, 0) !important;
        -webkit-transform: translate3d(0, 0, 0) !important;
        will-change: transform !important;
    }
    
    @media (prefers-color-scheme: dark) {
        .bottom-navbar {
            background-color: #2d2d30 !important;
            border-top-color: #555 !important;
        }
        
        .navbar-item:not(.active) {
            color: #e0e0e0 !important;
        }
    }
    
    /* iPhone 14 Pro Max and similar large screens */
    @media screen and (min-width: 428px) and (max-width: 932px) and (-webkit-device-pixel-ratio: 3) {
        .bottom-navbar {
            height: 70px !important;
            min-height: 70px !important;
            padding: 10px 0 !important;
            padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px) !important;
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 999999 !important;
        }
        
        body {
            padding-bottom: calc(80px + env(safe-area-inset-bottom, 0px)) !important;
        }
        
        .navbar-item .icon {
            font-size: 22px !important;
        }
        
        .navbar-item span {
            font-size: 12px !important;
        }
    }
    
    /* Enhanced mobile optimizations */
    @media (max-width: 768px) {
        .bottom-navbar {
            padding: 8px 0 !important;
            height: 60px !important;
            min-height: 60px !important;
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 99999 !important;
            transform: translateZ(0) !important;
            -webkit-backface-visibility: hidden !important;
            backface-visibility: hidden !important;
        }
        
        .navbar-item .icon {
            font-size: 18px !important;
        }
        
        .navbar-item span {
            font-size: 10px !important;
        }
        
        .navbar-item {
            padding: 2px 4px !important;
        }
    }
    
    /* Extra large mobile screens (iPhone 14 Pro Max, etc.) */
    @media (max-width: 932px) and (min-width: 768px) {
        .bottom-navbar {
            height: 65px !important;
            min-height: 65px !important;
            padding: 8px 0 !important;
            padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 8px) !important;
        }
        
        body {
            padding-bottom: calc(75px + env(safe-area-inset-bottom, 0px)) !important;
        }
    }
    
    /* Extra small screens */
    @media (max-width: 480px) {
        .bottom-navbar {
            height: 55px !important;
            min-height: 55px !important;
            padding: 6px 0 !important;
        }
        
        .navbar-item .icon {
            font-size: 16px !important;
            margin-bottom: 1px !important;
        }
        
        .navbar-item span {
            font-size: 9px !important;
        }
    }
    
    /* Very small screens */
    @media (max-width: 360px) {
        .navbar-item span {
            font-size: 8px !important;
        }
        
        .navbar-item .icon {
            font-size: 14px !important;
        }
    }
    
    /* Ensure main content doesn't get hidden behind navbar */
    body {
        padding-bottom: 70px !important;
        margin-bottom: 0 !important;
    }
    
    @media (max-width: 768px) {
        body {
            padding-bottom: 70px !important;
        }
    }
    
    @media (max-width: 480px) {
        body {
            padding-bottom: 65px !important;
        }
    }
    
    /* iOS Safari specific fixes - Enhanced for newer iPhones */
    @supports (-webkit-touch-callout: none) {
        .bottom-navbar {
            padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 8px) !important;
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 999999 !important;
        }
        
        body {
            padding-bottom: calc(70px + env(safe-area-inset-bottom, 0px)) !important;
        }
        
        /* Specific fix for iPhone 14 Pro Max */
        @media screen and (device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) {
            .bottom-navbar {
                height: 75px !important;
                min-height: 75px !important;
                padding: 12px 0 !important;
                padding-bottom: calc(env(safe-area-inset-bottom, 20px) + 12px) !important;
            }
            
            body {
                padding-bottom: calc(85px + env(safe-area-inset-bottom, 20px)) !important;
            }
        }
    }
    
    /* Force visibility on all devices with additional specificity */
    html .bottom-navbar {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: fixed !important;
        bottom: 0 !important;
        width: 100vw !important;
    }
    
    /* Debugging helper - remove after testing */
    .bottom-navbar::before {
        content: '';
        position: absolute;
        top: -1px;
        left: 0;
        right: 0;
        height: 1px;
        background: red;
        z-index: 1;
    }
</style>
